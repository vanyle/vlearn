name: vtoolbox
author: me
version: 0.1
tasks:
  release: 
    type: build
    timer: true
    source_path: src
    output_path: build
    linker: ar -crs
    ignore: 
      - test
    output_file: executable/libproject.a
    arguments: 
      - -fdiagnostics-color
      - -Wall
      - -D NDEBUG # disable assertions
      - -Os
      - -Isrc
      - -Iinclude
  
  doc:
    type: script
    name: doc.py
    arg: src

  gen_pdb:
    type: command
    commands:
      - cv2pdb executable/test.exe

  release_test:
    type: build
    timer: true
    source_path: src/test
    output_path: build
    output_file: executable/test.exe
    linker_arguments: ["-L./executable","-lproject", @include "libraries.yaml", "-static"]
    arguments:
      - -fdiagnostics-color
      - -Os
      - -Isrc
      - -g

  debug:
    copy: release
    output_file: executable/libproject.a
    arguments:
      - -fdiagnostics-color
      - -Wall
      - -O0
      - -g # add debugging data
      - -Isrc
      - -Iinclude

  run_debug:
    type: command
    commands:
      - cd executable & test.exe

  run:
    type: command
    commands:
      - cd executable & test.exe

  clean:
    type: command
    commands:
      - del /q ".\build\*"
      - FOR /D %p IN (".\build\*.*") DO rmdir "%p" /s /q